(this["webpackJsonpimjoy-chart-editor"]=this["webpackJsonpimjoy-chart-editor"]||[]).push([[0],{312:function(e,t,a){},984:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(36),o=a.n(r),s=(a(312),a(23)),c=a.n(s),i=a(52),l=a(106),u=a(107),d=a(108),p=a(113),h=a(111),j=a(112),b=a(292),f=a(74),m=a.n(f),O=a(10),x=a.n(O),S=a(116),v=a(164),y=a.n(v),g=a(165),P=a(8),k=a.n(P),w=a(5);function C(e,t){var a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download",e),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}var I=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(e,n){var r;return Object(l.a)(this,a),(r=t.call(this,e,n)).state={content:"Drop a file to upload here or click to choose a file from your computer."},r}return Object(u.a)(a,[{key:"onDrop",value:function(){var e=Object(i.a)(c.a.mark((function e(t,a){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.context.localize,!t.length){e.next=17;break}if(!(t.length>1)){e.next=5;break}return this.setState({content:Object(w.jsx)("div",{className:"dropzone-container__message",children:Object(w.jsx)("p",{children:n("Yikes! You can only upload one file at a time.")})})}),e.abrupt("return");case 5:return e.prev=5,this.setState({content:n("Loading...")}),e.next=9,this.props.handleLoadData(t[0]);case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(5),e.t0;case 14:return e.prev=14,this.setState({content:n("File loaded.")}),e.finish(14);case 17:a.length&&this.setState({content:"Failed to load file"});case 18:case"end":return e.stop()}}),e,this,[[5,11,14,17]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.context.localize,a=this.props.logoSrc&&Object(w.jsx)(y.a,{src:this.props.logoSrc}),n=[];if(this.props.dataSources)for(var r=0,o=Object.entries(this.props.dataSources);r<o.length;r++){var s=Object(j.a)(o[r],2),l=s[0],u=s[1];n.push(Object(w.jsxs)("li",{children:[l,":",u.length]},l))}var d=this.onDrop.bind(this);return Object(w.jsxs)(O.PanelMenuWrapper,{menuPanelOrder:this.props.menuPanelOrder,children:[a||null,Object(w.jsxs)(O.LayoutPanel,{group:t("Data"),name:t("Import"),children:[Object(w.jsx)(k.a,{children:Object(w.jsx)(g.default,{onDrop:d,activeClassName:"dropzone-container--active",rejectClassName:"dropzone-container--rejected",children:function(t){var a=t.getRootProps,n=t.getInputProps;return Object(w.jsxs)("div",Object(S.a)(Object(S.a)({},a()),{},{className:"dropzone-container",children:[Object(w.jsx)("input",Object(S.a)({},n())),Object(w.jsx)("div",{className:"dropzone-container__content",children:e.state.content})]}))}})}),Object(w.jsx)(O.Button,{variant:"primary",label:"Load from URL",onClick:function(){var t=prompt("Data URL");t&&e.props.handleLoadData(t)}})]}),Object(w.jsx)(O.GraphCreatePanel,{group:t("Structure"),name:t("Traces")}),Object(w.jsx)(O.GraphSubplotsPanel,{group:t("Structure"),name:t("Subplots")}),this.hasTransforms()&&Object(w.jsx)(O.GraphTransformsPanel,{group:t("Structure"),name:t("Transforms")}),Object(w.jsx)(O.StyleLayoutPanel,{group:t("Style"),name:t("General")}),Object(w.jsx)(O.StyleTracesPanel,{group:t("Style"),name:t("Traces")}),this.hasAxes()&&Object(w.jsx)(O.StyleAxesPanel,{group:t("Style"),name:t("Axes")}),this.hasMaps()&&Object(w.jsx)(O.StyleMapsPanel,{group:t("Style"),name:t("Maps")}),this.hasLegend()&&Object(w.jsx)(O.StyleLegendPanel,{group:t("Style"),name:t("Legend")}),this.hasColorbars()&&Object(w.jsx)(O.StyleColorbarsPanel,{group:t("Style"),name:t("Color Bars")}),Object(w.jsx)(O.StyleNotesPanel,{group:t("Annotate"),name:t("Text")}),Object(w.jsx)(O.StyleShapesPanel,{group:t("Annotate"),name:t("Shapes")}),Object(w.jsx)(O.StyleImagesPanel,{group:t("Annotate"),name:t("Images")}),this.hasSliders()&&Object(w.jsx)(O.StyleSlidersPanel,{group:t("Control"),name:t("Sliders")}),this.hasMenus()&&Object(w.jsx)(O.StyleUpdateMenusPanel,{group:t("Control"),name:t("Menus")}),this.props.children?this.props.children:null,Object(w.jsx)(O.LayoutPanel,{group:t("Annotate"),name:t("Info"),children:Object(w.jsx)(O.PlotlyFold,{name:"PlotlyFold",children:Object(w.jsxs)(O.Info,{attr:"title",children:[Object(w.jsx)("p",{children:"This custom editor demonstrates the general-purpose container and field components."}),Object(w.jsxs)("p",{children:["This is an ",Object(w.jsx)("code",{children:"Info"})," component."]})]})})}),Object(w.jsx)(O.LayoutPanel,{group:t("Export"),name:"image",children:Object(w.jsxs)(O.SingleSidebarItem,{children:[Object(w.jsx)(O.Button,{variant:"primary",label:"Export PNG",onClick:Object(i.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.toImage(e.props.divId,{format:"png",height:2048,width:2048});case 2:C("export.png",t.sent);case 4:case"end":return t.stop()}}),t)})))}),Object(w.jsx)(O.Button,{variant:"primary",label:"Export SVG",onClick:Object(i.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.toImage(e.props.divId,{format:"svg",height:1024,width:1024});case 2:C("export.svg",t.sent);case 4:case"end":return t.stop()}}),t)})))})]})}),this.props.saveCallback&&Object(w.jsx)(O.SingleSidebarItem,{children:Object(w.jsx)(O.Button,{variant:"primary",label:"save",onClick:Object(i.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log(e.props.data);case 1:case"end":return t.stop()}}),t)})))})})]})}}]),a}(O.DefaultEditor),L=(a(965),a(305)),_=a(306),D={editable:!0};function T(e){return new Promise((function(t,a){_.parse(e,{download:!0,header:!0,dynamicTyping:!0,skipEmptyLines:!0,error:function(e,t,n,r){alert("Falied to load the table: "+r.toString()),a(r)},complete:function(e){t(function(e){var t,a={},n=Object(b.a)(e);try{for(n.s();!(t=n.n()).done;)for(var r=t.value,o=0,s=Object.entries(r);o<s.length;o++){var c=Object(j.a)(s[o],2),i=c[0],l=c[1];a[i]=a[i]||[],a[i].push(l)}}catch(u){n.e(u)}finally{n.f()}return a}(e.data))}})}))}var z=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a),e=t.call(this);var n=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}("load");if(n?T(n).then((function(t){e.dataSources=t,e.dataSourceOptions=Object.keys(e.dataSources).map((function(e){return{value:e,label:e}})),e.forceUpdate()})):(e.dataSources={col1:[1,2,3],col2:[4,3,2],col3:[17,13,9]},e.dataSourceOptions=Object.keys(e.dataSources).map((function(e){return{value:e,label:e}}))),e.state={data:[],layout:{},frames:[]},window.self!==window.top){var r=Object(d.a)(e);L.imjoyRPC.setupRPC({name:"ImJoy Chart Editor"}).then((function(e){e.export({setup:function(){console.log("imjoy-rpc initialized.")},run:function(e){e&&e.data&&(r.state=e.data||{data:[],layout:{},frames:[]},r.dataSources=e.data.data_sources||{},r.dataSourceOptions=e.data.data_sources_options||Object.keys(r.dataSources).map((function(e){return{value:e,label:e}})),r.state.data_sources&&delete r.data.data_sources,r.state.data_sources_options&&delete r.data.data_sources_options),r.forceUpdate()},setState:function(e){r.state=e,r.forceUpdate()},getState:function(){return r.state}})}))}return e}return Object(u.a)(a,[{key:"loadData",value:function(){var e=Object(i.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(t);case 2:a=e.sent,this.dataSources=a,this.dataSourceOptions=Object.keys(this.dataSources).map((function(e){return{value:e,label:e}})),this.forceUpdate();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t="_"+Math.random().toString(36).substr(2,9);return Object(w.jsx)("div",{className:"app",children:Object(w.jsx)(x.a,{data:this.state.data,layout:this.state.layout,config:D,frames:this.state.frames,dataSources:this.dataSources,dataSourceOptions:this.dataSourceOptions,plotly:m.a,onUpdate:function(t,a,n){return e.setState({data:t,layout:a,frames:n})},useResizeHandler:!0,debug:!0,glByDefault:!0,showFieldTooltips:!0,advancedTraceTypeSelector:!0,divId:t,children:Object(w.jsx)(I,{logoSrc:"./static/icons/favicon-96x96.png",dataSources:this.dataSources,divId:t,data:this.state,handleLoadData:this.loadData.bind(this)})})})}}]),a}(n.Component);o.a.render(Object(w.jsx)(z,{}),document.getElementById("root"))}},[[984,1,2]]]);
//# sourceMappingURL=main.7ce02b8f.chunk.js.map