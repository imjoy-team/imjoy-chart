{"version":3,"sources":["CustomEditor.js","App.js","index.js"],"names":["download","filename","base64","element","document","createElement","setAttribute","style","display","body","appendChild","click","removeChild","CustomEditor","props","inputFile","React","createRef","exportWidth","exportHeight","exportFormat","exportFileName","_","this","context","localize","logo","logoSrc","src","dataSources","Object","entries","index","value","push","length","widgets","widget","type","name","padding","schema","uiSchema","onChange","e","apply","onSubmit","onError","width","objectFit","dangerouslySetInnerHTML","__html","exportChart","format","a","plotly","toImage","divId","height","replace","menuPanelOrder","group","hasTransforms","hasAxes","hasMaps","hasLegend","hasColorbars","hasSliders","hasMenus","children","label","v","forceUpdate","onUpdate","units","options","clearable","defaultValue","variant","onClick","handleLoadData","target","files","ref","current","handleSaveData","data","DefaultEditor","config","editable","loadCSV","url","Promise","resolve","reject","Papa","startsWith","header","dynamicTyping","skipEmptyLines","error","err","file","inputElem","reason","alert","toString","complete","results","result","row","key","transpose","getUrlParameter","RegExp","exec","location","search","decodeURIComponent","dtypeToTypedArray","int8","Int8Array","int16","Int16Array","int32","Int32Array","uint8","Uint8Array","uint16","Uint16Array","uint32","Uint32Array","float32","Float32Array","float64","Float64Array","array","Array","App","plotDivId","Math","random","substr","_initPromise","_initPromiseResolve","load","hideControls","saveDataHandler","then","dataSourceOptions","keys","map","col1","col2","col3","state","layout","frames","window","self","top","imjoyRPC","setupRPC","api","registerCodec","decoder","obj","_rdtype","ret","ArrayBuffer","_rvalue","byteLength","i","Int64LE","toNumber","Uint64LE","arrayType","export","setup","console","log","run","ctx","setState","loadDataSource","loadData","hide","setWidgets","addWidget","removeWidget","w","filter","wd","Error","splice","indexOf","updateWidget","getState","addListener","event","callback","getElementById","on","points","customdata","k","pointIndex","x","y","z","undefined","cleanUpPoints","removeAllListeners","setTimeout","split","endsWith","fetch","response","json","Blob","fr","FileReader","addEventListener","JSON","parse","readAsText","className","useResizeHandler","debug","glByDefault","showFieldTooltips","advancedTraceTypeSelector","bind","Component","ReactDOM","render"],"mappings":"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","file":"static/js/main.9173aaa9.chunk.js","sourcesContent":["import React from \"react\";\nimport plotly from \"plotly.js/dist/plotly\";\nimport Form from \"@rjsf/core\";\n\nimport {\n  PlotlyFold,\n  PanelMenuWrapper,\n  Info,\n  LayoutPanel,\n  Button,\n  SingleSidebarItem,\n  DefaultEditor,\n  GraphCreatePanel,\n  GraphTransformsPanel,\n  GraphSubplotsPanel,\n  StyleLayoutPanel,\n  StyleAxesPanel,\n  StyleMapsPanel,\n  StyleLegendPanel,\n  StyleNotesPanel,\n  StyleShapesPanel,\n  StyleSlidersPanel,\n  StyleImagesPanel,\n  StyleTracesPanel,\n  StyleColorbarsPanel,\n  StyleUpdateMenusPanel,\n} from \"react-chart-editor\";\nimport Field from \"react-chart-editor/lib/components/fields/Field\";\nimport Logo from \"react-chart-editor/lib/components/widgets/Logo\";\nimport NumericInput from \"react-chart-editor/lib/components/widgets/NumericInput\";\nimport DropdownWidget from \"react-chart-editor/lib/components/widgets/Dropdown\";\nimport TextInput from \"react-chart-editor/lib/components/widgets/TextInput\";\n\nfunction download(filename, base64) {\n  const element = document.createElement(\"a\");\n  element.setAttribute(\"href\", base64);\n  element.setAttribute(\"download\", filename);\n\n  element.style.display = \"none\";\n  document.body.appendChild(element);\n\n  element.click();\n\n  document.body.removeChild(element);\n}\nexport default class CustomEditor extends DefaultEditor {\n  constructor(props) {\n    super(props);\n    this.inputFile = React.createRef();\n    this.exportWidth = 1024;\n    this.exportHeight = 1024;\n    this.exportFormat = \"png\";\n    this.exportFileName = \"imjoy-chart-export\";\n  }\n\n  render() {\n    const _ = this.context.localize;\n    const logo = this.props.logoSrc && <Logo src={this.props.logoSrc} />;\n\n    const dataSources = [];\n    if (this.props.dataSources) {\n      for (const [index, value] of Object.entries(this.props.dataSources)) {\n        dataSources.push(\n          <li key={index}>\n            {index}:{value.length}\n          </li>\n        );\n      }\n    }\n\n    const widgets = [];\n    if (this.props.widgets) {\n      for (let widget of this.props.widgets) {\n        if (widget.type === \"form\") {\n          widgets.push(\n            <PlotlyFold name={widget.name} key={widget.name}>\n              <div style={{ padding: \"10px\" }}>\n                <Form\n                  schema={widget.schema}\n                  uiSchema={widget.uiSchema}\n                  onChange={(e) => {\n                    widget.onChange && widget.onChange.apply(null, [e]);\n                  }}\n                  onSubmit={(e) => {\n                    widget.onSubmit && widget.onSubmit.apply(null, [e]);\n                  }}\n                  onError={(e) => {\n                    widget.onError && widget.onError.apply(null, [e]);\n                  }}\n                />\n              </div>\n            </PlotlyFold>\n          );\n        } else if (widget.type === \"image\") {\n          widgets.push(\n            <PlotlyFold name={widget.name} key={widget.name}>\n              {widget.src && (\n                <img\n                  style={{ width: \"100%\", objectFit: \"cover\" }}\n                  src={widget.src}\n                ></img>\n              )}\n            </PlotlyFold>\n          );\n        } else if (widget.type === \"html\") {\n          widgets.push(\n            <PlotlyFold name={widget.name} key={widget.name}>\n              <div style={{ padding: \"10px\" }}>\n                <div dangerouslySetInnerHTML={{ __html: widget.body }} />\n              </div>\n            </PlotlyFold>\n          );\n        }\n      }\n    }\n\n    const exportChart = async (format) => {\n      format = format || this.exportFormat;\n      const base64 = await plotly.toImage(this.props.divId, {\n        format: format,\n        height: this.exportHeight,\n        width: this.exportWidth,\n      });\n      download(\n        this.exportFileName + \".\" + format.replace(\"full-json\", \"json\"),\n        base64\n      );\n    };\n    return (\n      <PanelMenuWrapper menuPanelOrder={this.props.menuPanelOrder}>\n        {logo ? logo : null}\n        <GraphCreatePanel group={_(\"Structure\")} name={_(\"Traces\")} />\n        <GraphSubplotsPanel group={_(\"Structure\")} name={_(\"Subplots\")} />\n        {this.hasTransforms() && (\n          <GraphTransformsPanel group={_(\"Structure\")} name={_(\"Transforms\")} />\n        )}\n        <StyleLayoutPanel group={_(\"Style\")} name={_(\"General\")} />\n        <StyleTracesPanel group={_(\"Style\")} name={_(\"Traces\")} />\n        {this.hasAxes() && (\n          <StyleAxesPanel group={_(\"Style\")} name={_(\"Axes\")} />\n        )}\n        {this.hasMaps() && (\n          <StyleMapsPanel group={_(\"Style\")} name={_(\"Maps\")} />\n        )}\n        {this.hasLegend() && (\n          <StyleLegendPanel group={_(\"Style\")} name={_(\"Legend\")} />\n        )}\n        {this.hasColorbars() && (\n          <StyleColorbarsPanel group={_(\"Style\")} name={_(\"Color Bars\")} />\n        )}\n        <StyleNotesPanel group={_(\"Annotate\")} name={_(\"Text\")} />\n        <StyleShapesPanel group={_(\"Annotate\")} name={_(\"Shapes\")} />\n        <StyleImagesPanel group={_(\"Annotate\")} name={_(\"Images\")} />\n        {this.hasSliders() && (\n          <StyleSlidersPanel group={_(\"Control\")} name={_(\"Sliders\")} />\n        )}\n        {this.hasMenus() && (\n          <StyleUpdateMenusPanel group={_(\"Control\")} name={_(\"Menus\")} />\n        )}\n        {this.props.children ? this.props.children : null}\n\n        {/* ---custom widgets-- */}\n        <LayoutPanel group={_(\"Info\")} name={_(\"Info\")}>\n          {widgets}\n        </LayoutPanel>\n        <LayoutPanel group={_(\"Export\")} name=\"image\">\n          <PlotlyFold>\n            <Field label=\"Width\">\n              <NumericInput\n                value={this.exportWidth}\n                onChange={(v) => {\n                  this.exportWidth = v;\n                  this.forceUpdate();\n                }}\n                onUpdate={(v) => {\n                  this.exportWidth = v;\n                  this.forceUpdate();\n                }}\n                units=\"px\"\n              />\n            </Field>\n            <Field label=\"Height\">\n              <NumericInput\n                value={this.exportHeight}\n                onChange={(v) => {\n                  this.exportHeight = v;\n                  this.forceUpdate();\n                }}\n                onUpdate={(v) => {\n                  this.exportHeight = v;\n                  this.forceUpdate();\n                }}\n                units=\"px\"\n              />\n            </Field>\n\n            <Field label=\"Format\">\n              <DropdownWidget\n                options={[\n                  { label: \"PNG\", value: \"png\" },\n                  { label: \"JPEG\", value: \"jpeg\" },\n                  { label: \"WEBP\", value: \"webp\" },\n                  { label: \"SVG\", value: \"svg\" },\n                  { label: \"JSON\", value: \"full-json\" },\n                ]}\n                value={this.exportFormat}\n                onChange={(v) => {\n                  this.exportFormat = v;\n                  this.forceUpdate();\n                }}\n                clearable={false}\n              />\n            </Field>\n            <Field label=\"File Name\">\n              <TextInput\n                value={this.exportFileName}\n                defaultValue={this.exportFileName}\n                onUpdate={(v) => {\n                  this.exportFileName = v;\n                  this.forceUpdate();\n                }}\n              />\n            </Field>\n\n            <Field>\n              <Button\n                variant=\"primary\"\n                label=\"Export\"\n                onClick={() => {\n                  exportChart();\n                }}\n              />\n            </Field>\n          </PlotlyFold>\n        </LayoutPanel>\n        <SingleSidebarItem>\n          <input\n            type=\"file\"\n            onChange={(e) => {\n              this.props.handleLoadData(e.target.files[0]);\n            }}\n            ref={this.inputFile}\n            style={{ display: \"none\" }}\n          />\n          <Button\n            variant=\"primary\"\n            label=\"Load\"\n            onClick={() => {\n              this.inputFile.current.click();\n            }}\n          />\n        </SingleSidebarItem>\n\n        <SingleSidebarItem>\n          <Button\n            variant=\"primary\"\n            label=\"save\"\n            onClick={async () => {\n              if (this.props.handleSaveData)\n                this.props.handleLoadData(this.props.data);\n              else exportChart(\"full-json\");\n            }}\n          />\n        </SingleSidebarItem>\n      </PanelMenuWrapper>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport plotly from \"plotly.js/dist/plotly\";\nimport PlotlyEditor from \"react-chart-editor\";\nimport CustomEditor from \"./CustomEditor\";\nimport \"react-chart-editor/lib/react-chart-editor.css\";\nimport { imjoyRPC } from \"imjoy-rpc\";\nimport * as Papa from \"papaparse\";\nimport { Uint64LE, Int64LE } from \"int64-buffer\";\n\nconst config = { editable: true };\n\nfunction loadCSV(url) {\n  return new Promise((resolve, reject) => {\n    Papa.parse(url, {\n      download: url.startsWith(\"http\"),\n      header: true,\n      dynamicTyping: true,\n      skipEmptyLines: true,\n      error: (err, file, inputElem, reason) => {\n        alert(\"Falied to load the table: \" + reason.toString());\n        reject(reason);\n      },\n      complete: (results) => {\n        resolve(transpose(results.data));\n      },\n    });\n  });\n}\n\nfunction transpose(data) {\n  let result = {};\n  for (let row of data) {\n    for (let [key, value] of Object.entries(row)) {\n      result[key] = result[key] || [];\n      result[key].push(value);\n    }\n  }\n  return result;\n}\n\nfunction randId() {\n  return \"_\" + Math.random().toString(36).substr(2, 9);\n}\n\nfunction getUrlParameter(name) {\n  name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\n  var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\");\n  var results = regex.exec(location.search);\n  return results === null\n    ? \"\"\n    : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\n}\n\nfunction cleanUpPoints(dataSources, points) {\n  const data = [];\n  for (let i = 0; i < points.length; i++) {\n    const customdata = {};\n    for (let k of Object.keys(dataSources)) {\n      customdata[k] = dataSources[k][points[i].pointIndex];\n    }\n    data.push({\n      pointIndex: points[i].pointIndex,\n      x: points[i].x,\n      y: points[i].y,\n      z: points[i].z || undefined,\n      customdata: customdata,\n    });\n  }\n  return data;\n}\n\nconst dtypeToTypedArray = {\n  int8: Int8Array,\n  int16: Int16Array,\n  int32: Int32Array,\n  uint8: Uint8Array,\n  uint16: Uint16Array,\n  uint32: Uint32Array,\n  float32: Float32Array,\n  float64: Float64Array,\n  array: Array,\n};\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.widgets = [];\n    this.plotDivId = randId();\n    this._initPromise = new Promise((resolve) => {\n      this._initPromiseResolve = resolve;\n    });\n    let load = getUrlParameter(\"load\");\n    this.hideControls = !!getUrlParameter(\"hideControls\");\n    this.saveDataHandler = null;\n    if (load) {\n      loadCSV(load).then((data) => {\n        this.dataSources = data;\n        this.dataSourceOptions = Object.keys(this.dataSources).map((name) => ({\n          value: name,\n          label: name,\n        }));\n        this.forceUpdate();\n      });\n    } else {\n      this.dataSources = {\n        col1: [1, 2, 3], // eslint-disable-line no-magic-numbers\n        col2: [4, 3, 2], // eslint-disable-line no-magic-numbers\n        col3: [17, 13, 9], // eslint-disable-line no-magic-numbers\n      };\n\n      this.dataSourceOptions = Object.keys(this.dataSources).map((name) => ({\n        value: name,\n        label: name,\n      }));\n    }\n    this.state = {\n      data: [],\n      layout: {},\n      frames: [],\n    };\n    // if inside an iframe, setup imjoy rpc\n    if (window.self !== window.top) {\n      const self = this;\n      imjoyRPC.setupRPC({ name: \"ImJoy Chart Editor\" }).then((api) => {\n        api.registerCodec({\n          name: \"ndarray\",\n          decoder(obj) {\n            if (obj._rdtype === \"int64\") {\n              const ret = new Uint32Array(\n                new ArrayBuffer(obj._rvalue.byteLength / 2)\n              );\n              for (let i = 0; i < obj._rvalue.byteLength; i += 8) {\n                ret[i / 8] = new Int64LE(obj._rvalue, i).toNumber();\n              }\n              return ret;\n            }\n            if (obj._rdtype === \"uint64\") {\n              const ret = new Uint32Array(\n                new ArrayBuffer(obj._rvalue.byteLength / 2)\n              );\n              for (let i = 0; i < obj._rvalue.byteLength; i += 8) {\n                ret[i / 8] = new Uint64LE(obj._rvalue, i).toNumber();\n              }\n              return ret;\n            }\n            const arrayType = dtypeToTypedArray[obj._rdtype];\n            return new arrayType(obj._rvalue);\n          },\n        });\n        api.export({\n          async setup() {\n            console.log(\"imjoy-rpc initialized.\");\n            await self._initPromise;\n          },\n          async run(ctx) {\n            if (ctx && ctx.config) {\n              self.saveDataHandler = ctx.config.saveDataHandler;\n              self.hideControls = ctx.config.hideControls;\n            }\n            if (ctx && ctx.data) {\n              self.dataSources = ctx.data.dataSources || {};\n              self.dataSourceOptions =\n                ctx.data.dataSourceOptions ||\n                Object.keys(self.dataSources).map((name) => ({\n                  value: name,\n                  label: name,\n                }));\n              if (self.state.dataSources) delete self.state.dataSources;\n              if (self.state.dataSourceOptions)\n                delete self.state.dataSourceOptions;\n              self.setState(ctx.data);\n            }\n            self.forceUpdate();\n          },\n          async loadDataSource(file) {\n            await self.loadData(file);\n          },\n          hideControls(hide) {\n            self.hideControls = hide;\n            self.forceUpdate();\n          },\n          setWidgets(widgets) {\n            self.widgets = widgets;\n            self.forceUpdate();\n          },\n          addWidget(widget) {\n            self.widgets.push(widget);\n            self.forceUpdate();\n          },\n          removeWidget() {\n            const w = self.widgets.filter((wd) => wd.name === widget.name)[0];\n            if (w) {\n              // remove widget\n              self.widgets.splice(self.widgets.indexOf(w), 1);\n              self.forceUpdate();\n            } else {\n              throw new Error(\"Widget not found: \" + widget.name);\n            }\n          },\n          updateWidget(widget) {\n            const w = self.widgets.filter((wd) => wd.name === widget.name)[0];\n            if (w) {\n              // replace widget\n              self.widgets[self.widgets.indexOf(w)] = widget;\n              self.forceUpdate();\n            } else {\n              throw new Error(\"Widget not found: \" + widget.name);\n            }\n          },\n          setState(state) {\n            self.setState(state);\n            self.forceUpdate();\n          },\n          getState() {\n            return self.state;\n          },\n          addListener({ event, callback }) {\n            document.getElementById(self.plotDivId).on(event, (data) => {\n              if (data.points)\n                callback(cleanUpPoints(self.dataSources, data.points));\n              else {\n                callback(data);\n              }\n            });\n          },\n          removeAllListeners(event) {\n            document.getElementById(self.plotDivId).removeAllListeners(event);\n          },\n        });\n      });\n    }\n  }\n\n  componentDidMount() {\n    setTimeout(() => {\n      this._initPromiseResolve();\n    }, 0);\n  }\n\n  async loadData(file) {\n    let data;\n    if (typeof file === \"object\") {\n      data = file;\n    } else {\n      if (typeof file === \"string\" && file.startsWith(\"http\")) {\n        if (file.split(\"?\")[0].endsWith(\".json\")) {\n          const response = await fetch(file);\n          const data = await response.json();\n          if (data.data && data.layout) {\n            this.setState(data);\n            this.forceUpdate();\n          } else {\n            throw new Error(\"Invalid file type\");\n          }\n        } else if (!file.split(\"?\")[0].endsWith(\".csv\")) {\n          throw new Error(\n            \"Invalid file extension, only .json and .csv are supported\"\n          );\n        }\n      } else if (file instanceof Blob) {\n        if (file.name.endsWith(\".json\")) {\n          const fr = new FileReader();\n          fr.addEventListener(\"load\", (e) => {\n            const data = JSON.parse(fr.result);\n            if (data.data && data.layout) {\n              this.setState(data);\n              this.forceUpdate();\n            } else {\n              throw new Error(\"Invalid file type\");\n            }\n          });\n\n          fr.readAsText(file);\n        }\n      }\n      data = await loadCSV(file);\n    }\n    this.dataSources = data;\n    this.dataSourceOptions = Object.keys(this.dataSources).map((name) => ({\n      value: name,\n      label: name,\n    }));\n    this.forceUpdate();\n  }\n\n  render() {\n    return (\n      <div className=\"app\">\n        <PlotlyEditor\n          hideControls={this.hideControls}\n          data={this.state.data}\n          layout={this.state.layout}\n          config={config}\n          frames={this.state.frames}\n          dataSources={this.dataSources}\n          dataSourceOptions={this.dataSourceOptions}\n          plotly={plotly}\n          onUpdate={(data, layout, frames) => {\n            this.setState({ data, layout, frames });\n          }}\n          useResizeHandler\n          debug\n          glByDefault\n          showFieldTooltips\n          advancedTraceTypeSelector\n          divId={this.plotDivId}\n        >\n          <CustomEditor\n            logoSrc={\"./static/icons/favicon-96x96.png\"}\n            dataSources={this.dataSources}\n            divId={this.plotDivId}\n            data={this.state}\n            widgets={this.widgets}\n            handleSaveData={this.saveDataHandler}\n            handleLoadData={this.loadData.bind(this)}\n          />\n        </PlotlyEditor>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}